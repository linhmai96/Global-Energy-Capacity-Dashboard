[2025-04-13 18:43:53,736] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: transform_and_load.transform_and_load scheduled__2025-04-12T00:00:00+00:00 [queued]>
[2025-04-13 18:43:53,746] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: transform_and_load.transform_and_load scheduled__2025-04-12T00:00:00+00:00 [queued]>
[2025-04-13 18:43:53,747] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2025-04-13 18:43:53,747] {taskinstance.py:1239} INFO - Starting attempt 2 of 2
[2025-04-13 18:43:53,747] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2025-04-13 18:43:53,759] {taskinstance.py:1259} INFO - Executing <Task(DataprocSubmitJobOperator): transform_and_load> on 2025-04-12 00:00:00+00:00
[2025-04-13 18:43:53,763] {standard_task_runner.py:52} INFO - Started process 848 to run task
[2025-04-13 18:43:53,766] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'transform_and_load', 'transform_and_load', 'scheduled__2025-04-12T00:00:00+00:00', '--job-id', '1363', '--raw', '--subdir', 'DAGS_FOLDER/dag_data_transform.py', '--cfg-path', '/tmp/tmp41mkxbg4', '--error-file', '/tmp/tmp03m5gi8n']
[2025-04-13 18:43:53,768] {standard_task_runner.py:77} INFO - Job 1363: Subtask transform_and_load
[2025-04-13 18:43:53,816] {logging_mixin.py:109} INFO - Running <TaskInstance: transform_and_load.transform_and_load scheduled__2025-04-12T00:00:00+00:00 [running]> on host 502d6bc01544
[2025-04-13 18:43:53,859] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=transform_and_load
AIRFLOW_CTX_TASK_ID=transform_and_load
AIRFLOW_CTX_EXECUTION_DATE=2025-04-12T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2025-04-12T00:00:00+00:00
[2025-04-13 18:43:53,860] {dataproc.py:1997} INFO - Submitting job
[2025-04-13 18:43:53,861] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2025-04-13 18:43:54,163] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.6/site-packages/google/api_core/grpc_helpers.py", line 67, in error_remapped_callable
    return callable_(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.6/site-packages/grpc/_channel.py", line 946, in __call__
    return _end_unary_response_blocking(state, call, False, None)
  File "/home/airflow/.local/lib/python3.6/site-packages/grpc/_channel.py", line 849, in _end_unary_response_blocking
    raise _InactiveRpcError(state)
grpc._channel._InactiveRpcError: <_InactiveRpcError of RPC that terminated with:
	status = StatusCode.PERMISSION_DENIED
	details = "Permission denied on resource project #Update your projectID."
	debug_error_string = "{"created":"@1744569834.162888367","description":"Error received from peer ipv4:142.250.191.170:443","file":"src/core/lib/surface/call.cc","file_line":1063,"grpc_message":"Permission denied on resource project #Update your projectID.","grpc_status":7}"
>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/providers/google/cloud/operators/dataproc.py", line 2006, in execute
    metadata=self.metadata,
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/providers/google/common/hooks/base_google.py", line 430, in inner_wrapper
    return func(self, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/providers/google/cloud/hooks/dataproc.py", line 979, in submit_job
    metadata=metadata,
  File "/home/airflow/.local/lib/python3.6/site-packages/google/cloud/dataproc_v1/services/job_controller/client.py", line 412, in submit_job
    response = rpc(request, retry=retry, timeout=timeout, metadata=metadata,)
  File "/home/airflow/.local/lib/python3.6/site-packages/google/api_core/gapic_v1/method.py", line 145, in __call__
    return wrapped_func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.6/site-packages/google/api_core/grpc_helpers.py", line 69, in error_remapped_callable
    six.raise_from(exceptions.from_grpc_error(exc), exc)
  File "<string>", line 3, in raise_from
google.api_core.exceptions.PermissionDenied: 403 Permission denied on resource project #Update your projectID.
[2025-04-13 18:43:54,174] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=transform_and_load, task_id=transform_and_load, execution_date=20250412T000000, start_date=20250413T184353, end_date=20250413T184354
[2025-04-13 18:43:54,183] {standard_task_runner.py:92} ERROR - Failed to execute job 1363 for task transform_and_load
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.6/site-packages/google/api_core/grpc_helpers.py", line 67, in error_remapped_callable
    return callable_(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.6/site-packages/grpc/_channel.py", line 946, in __call__
    return _end_unary_response_blocking(state, call, False, None)
  File "/home/airflow/.local/lib/python3.6/site-packages/grpc/_channel.py", line 849, in _end_unary_response_blocking
    raise _InactiveRpcError(state)
grpc._channel._InactiveRpcError: <_InactiveRpcError of RPC that terminated with:
	status = StatusCode.PERMISSION_DENIED
	details = "Permission denied on resource project #Update your projectID."
	debug_error_string = "{"created":"@1744569834.162888367","description":"Error received from peer ipv4:142.250.191.170:443","file":"src/core/lib/surface/call.cc","file_line":1063,"grpc_message":"Permission denied on resource project #Update your projectID.","grpc_status":7}"
>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/providers/google/cloud/operators/dataproc.py", line 2006, in execute
    metadata=self.metadata,
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/providers/google/common/hooks/base_google.py", line 430, in inner_wrapper
    return func(self, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/providers/google/cloud/hooks/dataproc.py", line 979, in submit_job
    metadata=metadata,
  File "/home/airflow/.local/lib/python3.6/site-packages/google/cloud/dataproc_v1/services/job_controller/client.py", line 412, in submit_job
    response = rpc(request, retry=retry, timeout=timeout, metadata=metadata,)
  File "/home/airflow/.local/lib/python3.6/site-packages/google/api_core/gapic_v1/method.py", line 145, in __call__
    return wrapped_func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.6/site-packages/google/api_core/grpc_helpers.py", line 69, in error_remapped_callable
    six.raise_from(exceptions.from_grpc_error(exc), exc)
  File "<string>", line 3, in raise_from
google.api_core.exceptions.PermissionDenied: 403 Permission denied on resource project #Update your projectID.
[2025-04-13 18:43:54,224] {local_task_job.py:154} INFO - Task exited with return code 1
[2025-04-13 18:43:54,246] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
